{
  "hash": "7649e0e44d442d13ff8b7a9fbc125531",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Reverse engineering Janome embroidery cards (part 3)\"\ndate: 2026-01-02\nexecute:\n  echo: false\n---\n\n\n\n\n\n\n\nI did most of the work in this post back in the summer; I've only just got round to writing it up. In [part 2](janome_2.html), I'd attempted to use a Pi Pico to emulate the ROM in the memory cards, without any luck, and had ordered some chips to write to directly.\n\n## Writing flash chips\n\nThis proved to be more of a hassle than I was expecting.  I cobbled together a \ncircuit with an Arduino to write to the chips.  Eventually I realised that the\nchips I'd got from ebay were faulty; I couldn't reliably read back the data that\nhad been written to them. One just seemed to have a few bad areas on it, so I was\nreasonably confident my circuit was OK.   I ended up buying a couple more chips\nfrom a UK seller, and was able to successfully write to these.\n\n(One thing to note with them is that they're quite slow to erase - it can be ~20\nseconds after sending the erase command before it completes).\n\nHaving got a chip written with a copy of one of the official cards, I tried connecting\nit to the machine with the [connector I'd bought of AliExpress](janome_2.html#alternative-connectors).\nThis didn't work; the machine behaved in the same crazy way as with the Pi Pico.\n\nI concluded that the connector wasn't making a reliable connection with the machine.\n\nAt this point my plan was to wait for a common official card to come up on eBay, desolder its\nconnector and use that.\n\n## Customizer 2000\n\nAs I mentioned in the [first post](janome.html#other-tools), Janome made a Customizer 2000\nfor their successors to the Memory Craft 8000.  These took physically identical cards to the \n8000, but had a larger capacity.  I _think_ the 8000 cards could be used in the newer models,\nbut not vice versa.\n\nI'd had an eBay search for one of these for ages, but they came up rarely and were either \nin the USA, or silly money.  Back in August one came up, which I got for Â£15.  \n\nI'd previously managed to find a copy of the software for this on the Wayback Machine's copy\nof Janome's website, via a comment on the [hackaday project](https://hackaday.io/project/188230-reverse-engineering-the-janome-memory-cards).\nThis seemed to work fine under Wine, so I was reasonably confident I'd \nbe able to get the Customizer talking to my laptop once I'd bought a USB to Serial converter.\n\n![The (animated!) Easy Import spash screen.  Definite Geocities vibes](images/easy_import_splash.mp4)\n\nThe Customizer 2000 came with a 4Mbit card (labelled \"Card for Scanner\").  The software allows you to\nsave multiple designs and write them to a physical card via the reader.  Usefully\nit also allows you to save the combined (and presumably processed) designs to a ROM\nimage which you can later write to the physical card.\n\nThis all proved surprisingly easy to set up. I tried dumping one of my dumps of the official cards to the scanner card, and remarkably this worked\n(despite it being 1/4 the size of the image the software was presumably expecting).\n\n## Custom designs\n\nI'd previously [made some progress](janome.html#decoding-the-rom) figuring out the format\nof the data on the official cards, and had identified where the start and end address\nof each colour block for each design was stored.\n\nI modified the [pyembroidery](https://github.com/EmbroidePy/pyembroidery) to create a\nminimal (and *very* rough) script to overwrite one of the images on a dump of one of the\nofficial cards.  [The code for this is here](https://github.com/mawds/pyembroidery/tree/mc8000).\n\nI had some trouble with getting the design in the right place on the machine (and some horrid \ncrunchy noises as it ran beyond its limits).\n\nThe script is very minimal and rough, but it does work:\n\n![Some simple shapes and text from Inkstitch](images/example.jpg)\n![A more complicated design from Inkstitch](images/example_2.jpg)\n\n## (Possible) next steps\n\nTBH I've spent far, far too long on this project.  If I do anything further, it'd be\ninteresting to try and get either the flash chips or (ideally) the Pi Pico working\nto drive the sewing machine.  \n\nI originally thought the Pico wasn't working because it was\ntaking too long for it to initalise on power up, but given the flash chips didn't work\nI suspect the connector may have been the issue.  It's annoying that the connectors are\nno longer available; if I can get a common official card cheaply I may sacrifice it for its\nconnector to see if this works. If it does that would make something like the [A8PicoCart](https://github.com/robinhedwards/A8PicoCart), \nwhere you copy the game/design to a mass storage device, and it outputs it to the host machine,  potentially feasible.\n\nOn the software side, my very, very,  shonky code needs a proper clean up.  It'd be good to remove  \nthe dependency on an official rom image, but I think that would be very difficult. As well as\nthe designs, the user interface and (I suspect) some of the firmware is on there. \n\nI suspect I could get a little further with the rom, to potentially handle the number\nof colours in a design better (and perhaps handle >6 colours).\n\nIf I can't get it working with a custom circuit, it'd be good to figure out how\nto drive the Customizer 2000 from Python, to remove the dependency on the\nEasy Import software.  I did have a brief go at intercepting the serial communications\nin Linux, but didn't get very far.\n\n\n\n\n\n\n\n",
    "supporting": [
      "janome_3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}